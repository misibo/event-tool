{% extends 'layout.html' %}
{% from 'macros.html' import render_user_avatar, render_field %}

{% block title %}
Einladen
{% endblock %}

{% block head %}
{{ simplemde.css }}
{{ simplemde.js }}
{% endblock %}

{% block content %}
<div class="uk-text-center">
    <h2>
        Infomail für Anlass
        <a class="uk-link-toggle" href="{{ url_for('event.view', id=event.id) }}">
            <span class="uk-link-heading">{{ event.name }}</span>
        </a>
    </h2>
</div>
<form method="POST">
    {{ form.csrf_token }}
    <div uk-grid>
        <div class="uk-width-expand">
            Alle Mitglieder in
            {{ 'den Gruppen' if event.groups|length > 1 else 'der Gruppe' }}
            {% for group in event.groups %}
                <a class="uk-link-toggle" href="{{ url_for('group.view', slug=group.slug) }}">
                    <span class="uk-link-heading">{{ group.name }}</span>
                </a>
                {% if not loop.last %}
                    {% if loop.revindex > 1 %}
                        ,
                    {% else %}
                        und
                    {% endif %}
                {% endif %}
            {% endfor %}
            werden informiert.
        </div>
        <div>
            <input class="uk-button uk-button-primary" type="submit" value="Senden">
        </div>
    </div>
    <div class="uk-grid-divider" uk-grid>
        <div class="uk-width-expand">
            {{ render_field(form.annotation, class='uk-textarea', rows=5, placeholder='Anmerkung') }}
            {{ render_field(form.event_details, class='uk-textarea', rows=5, placeholder='Anmerkung') }}
            {{ simplemde.load_id("event_details") }}
        </div>
        <div class="uk-width-1-3@s uk-width-1-4@l">
            {% if spectators %}
            <div class="uk-alert-primary" uk-alert>
                Zuschauer erhalten nur die Info, können sich aber nicht an- oder abmelden.
            </div>
            <div class="uk-grid-small" uk-grid>
                {% for user in uninvited %}
                <div>
                    <div class="uk-flex uk-flex-center uk-margin-small-bottom">
                        {{ render_user_avatar(user, resolution=32) }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if uninvited %}
            <hr>
            <div class="uk-alert-primary" uk-alert>
                Folgende Personen werden eingeladen d.h. sie können sich an- oder abmelden.
            </div>
            <div class="uk-grid-small" uk-grid>
                {% for user in uninvited %}
                <div>
                    <div class="uk-flex uk-flex-center uk-margin-small-bottom">
                        {{ render_user_avatar(user, resolution=32) }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if participants %}
            <hr>
            <div class="uk-alert-primary" uk-alert>
                Eingeladene oder bereits angemeldete Personen erhalten ein Update d.h. sie können sich immer noch an- oder abmelden.
            </div>
            <div class="uk-grid-small" uk-grid>
                {% for participant in participants %}
                <div>
                    <div class="uk-flex uk-flex-center uk-margin-small-bottom">
                        {{ render_user_avatar(participant.user, resolution=32) }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</form>
{% endblock %}
